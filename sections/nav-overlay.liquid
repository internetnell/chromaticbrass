<style>
  .nav {
    position: fixed;
    left: 0;
    top: 0;
    width: 0;
    height: 100vh;
    overflow-x: hidden;
    z-index: 999;
    background: var(--color-contrast);
  }
  .nav-list {
    list-style: none;
    margin: 0;
    padding: 0;
    padding-bottom: var(--space-sm);
  }
  .nav-overlay button {
    grid-column: 15 / span 1;
  }

  .nav-overlay ul {
    margin: 0;
    padding: 0;
    grid-column: 1 / span 16;
  }

  .nav-link {
    color: var(--color-bg);
    text-decoration: none;
  }
</style>

<nav class="nav js-nav">
    <div class="nav-overlay container">
      <button href="javascript:void(0)" class="closebtn" onclick="closeNav()">close</button>

      <ul>
        {% for link in linklists['main-nav'].links %}
          <li class="h2 nav-list">
            <a class="nav-link" href="{{ link.url }}">{{ link.title }}</a>
          </li>
        {% endfor %}
      </ul>
    </div>
</nav>



<script>
  function openNav(e) {
    if (e) e.preventDefault();
    const nav = document.querySelector('.js-nav');
    const navToggler = document.querySelector('.js-nav-toggler');
    if (!nav || !navToggler) return;

    // Show and expand overlay
    nav.style.display = 'block';
    nav.style.width = '100%';

    // Button state + a11y
    navToggler.classList.add('active');
    navToggler.setAttribute('aria-expanded', 'true');

    // Optional: lock body scroll while menu is open
    document.body.classList.add('no-scroll');
  }

  // Closes the overlay nav by setting width to 0
  function closeNav(e) {
    if (e) e.preventDefault();
    const nav = document.querySelector('.js-nav');
    const navToggler = document.querySelector('.js-nav-toggler');
    if (!nav || !navToggler) return;

    nav.style.width = '0%';

    // After the width transition ends, hide it for accessibility/interaction
    const onTransitionEnd = () => {
      nav.style.display = 'none';
      nav.removeEventListener('transitionend', onTransitionEnd);
    };
    nav.addEventListener('transitionend', onTransitionEnd);

    navToggler.classList.remove('active');
    navToggler.setAttribute('aria-expanded', 'false');
    document.body.classList.remove('no-scroll');
  }

  // Hook up the hamburger to open the nav
  document.addEventListener('DOMContentLoaded', () => {
    const navToggler = document.querySelector('.js-nav-toggler');
    if (!navToggler) return;

    navToggler.addEventListener('click', openNav);

    // Close on Escape for accessibility
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeNav(e);
    });
  });
</script>